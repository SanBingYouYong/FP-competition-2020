module Main where

import Graphics.Gloss
import Coordinate

--Colors -> makeColorI Red Green Blue Alpha
yellowC = makeColorI 193 165 141 255
whiteC = makeColorI 255 255 255 255
greenC = makeColorI 112 165 123 255
brownC = makeColorI 192 148 103 255
yellowTC = makeColorI 249 246 213 255
y2 = makeColorI 255 232 177 240

list :: [(Float, Float, Color , Float)]
-- x, y, color, radius
list = 
    coorLeft

    ++(addColour  (listParta) yellowC)++(addColour (listParta2) brownC)

    ++(addColour (listPartb) brownC)++(addColour (listPartb2) yellowTC) ++(addColour listPartb3 yellowTC)

    ++(addColour listParte1 brownC) ++listParte2 ++listParte3

    ++listParth `addR` 0.3
    ++listPartg
    ++listPartf1
    ++listParti
    ++listPartd1 `addR` 0.5
    ++listPartc `addR` 0.5
    ++listPartj++listPartj2++listPartj3++listPartj4++listPartj5


--part a
listParta :: [(Float, Float, Float)]
listParta = [(713,156,3.9),(718,165,3.6),(727,171,3.2),(735,176,2.7),(747,180,2.4)]

listParta2 :: [(Float, Float, Float)]
listParta2 = map (\(x, y, r) -> (x-7, y + 5.5-(x-700)/10, r + 0.5)) listParta

--part b
listPartb :: [(Float, Float, Float)]
listPartb = extendLine (811, 187, 2.4) 3 9 0.7 7



listPartb2 :: [(Float, Float, Float)]
listPartb2 = [(854, 251.5 + 5.5 + 6, 5), (855, 251.5 + 9.8 * 2 -3 + 6, 5), (856.5, 251.5 + 10.3 * 3 + 6, 5), (855, 251.5 + 10.3 * 4 + 6, 5), (852, 251.5 + 10.3 * 5 + 6, 5), (850, 251.5 + 10.3 * 6 + 6, 5)]

listPartb3 :: [(Float, Float, Float)]
listPartb3 = [(833, 236, 3), (837, 246, 3), (839, 252, 3), (841, 257, 3), (842, 263, 3.5), (839 + 4.5, 273, 4), (841 + 3, 284, 5.5), (842, 294, 5.8), (840, 305, 6.2), (836, 317, 7.4)]


--part e
listParte1 :: [(Float, Float, Float)]
listParte1 = [(668,213,3),(675,212,3.2),(682,217,3.3),(673,220,3.7),(683,229,5),(673,231,4.35),(679,238,4),(668,240,4),(675,248,3.5),(667,251,3.5),(676,258,3),(668,260,2.6),(675,269,6.7),(666,275,4),(658,282,3),(652,288,2)]

listParte2 :: [(Float, Float, Color,Float)]
listParte2 = addColour [(711, 231, 3), (718, 232, 2.7), (715, 240, 3.6), (728, 249, 3), (724, 241, 3.5), (718, 249, 4.5), (730, 257, 3.6)] brownC 
    ++ addColour [(720, 261, 6.5), (730, 267, 4.6), (716, 273, 6.2), (727, 279, 6.5),(709,284,6.5),(721,289,6.5),(700,292,4.5),(711,298,3.6),(703,302,3.4),(694,306,2.9)] y2
    ++ addColour [(686,301,2.5),(689,307,2.6),(679,307,3.8),(669,308,3.8),(654,308,9),(640,305,6),(628,306,4)] brownC

listParte3 :: [(Float, Float, Color, Float)]
listParte3 = addColour [(733,234,2.5),(740,237,2.6),(739,244,2.4),(746,240,2.7),(751,246,2.7),(746,250,2.6),(756,253,3.2),(749,256,2.9),(759,260,3.6),(752,263,3.4),(763,269,3.8),(754,273,3.7),(764,278,4),(765,291,6)] brownC
 ++ addColour [(754,284,4.4),(763,304,6),(753,295,6),(758,319,8.5),(747,307,6.9)] y2 ++[(742,321,whiteC,6)]

--part h
listParth :: [(Float, Float, Color, Float)]
listParth = addColour [(563,239,3),(558,245,3.4),(552,252,4),(545,261,5.8),(545,274,4)] whiteC
 ++addColour [(647,217,3.2),(643,224,3.1),(639,230,3),(635,237,2.8),(632,243,2.8),(628,248,2.6),(623,252,2.5),(618,256,2.7),(612,260,3),(607,263,3.2),(599,268,3.5),(590,271,4.3),(584,281,5.5)] whiteC
 ++addColour [(654,221,3.2),(650,228,3.2),(645,236,2.9),(641,242,2.8),(637,247,2.7),(633,253,2.8),(628,257,3),(622,262,3.2),(616,266,3.3),(609,271,3.4),(603,275,3.4),(596,281,3.8),(593,290,3.8),(584,296,3.8)] whiteC
--part g
listPartg :: [(Float, Float, Color, Float)]
listPartg = addColour [(580,224,3),(579,230,3),(581,237,3),(586,242,3),(591,245,3),(598,246,3),(605,246,3),(610,243,3),(616,239,3),(619,233,3),(621,226,3),(620,219,3),(618,214,3)]greenC
 ++[(607,224,whiteC,3)]

--part f
listPartf1 :: [(Float, Float, Color, Float)]
listPartf1 = addColour [(602,139,3),(611,143,3),(618,146,3.1),(625,147,2.8),(630,152,3),(605,146,3.1),(611,152,3.6),(621,154,4.3),(614,161,3.6),(610,168,3),(604,175,4),(596,181,3.6),(591,187,3.2),(586,193,3),(582,198,2.7)] whiteC
 ++(addColour[(658,159,4),(662,167,2.8),(653,168,4),(645,174,3.5)] yellowTC)`addR`0.3
 ++(addColour[(661,177,5.5),(651,182,3.7),(640,183,5.2),(628,188,5.8),(616,189,4.8),(608,193,3.7),(601,196,3)]whiteC)`addR`0.3
 ++ (addColour[(660,187,3.4),(652,193,4),(640,196,5.8),(629,199,4),(620,199,3.7),(611,201,3),(604,201,2.8)]whiteC)`addR`0.2
 ++(addColour[(595,201,3.8),(587,205,2.97),(582,208,2.7),(576,211,2.8),(571,216,2.8)]whiteC)`addR`0.3


--part i
listParti :: [(Float, Float, Color, Float)]
listParti = addColour  [(558, 213, 3 + 0.3), (553, 208, 3.2 + 0.3), (547, 202, 3.8 + 0.3), (541, 193, 4.2 + 0.3), (536, 184, 4.6 + 0.3), (533, 171, 4.6 + 0.3), (531, 157, 6 + 0.3), (531, 140, 4), (524, 131, 3.5), (518, 122, 3.3), (527, 122, 3), (535, 127, 3.2), (542, 134, 3.4), (543, 147, 4), (544, 158, 3.4), (543, 168, 3.2), (546, 178, 3.2), (547, 186, 3), (551, 193, 3), (555, 200, 2.8)] brownC `addR` 0.4
    ++addColour [(555,156,3),(556,149,3),(557,144,3),(558,137,3),(558,131,3),(558,125,3),(557,119,3),(557,112,3),(557,106,3),(558,100,3),(560,93,3),(562,88,3),(564,81,3),(567,75,3),(570,67,3),(574,61,3),(578,54,3)] whiteC
    ++addColour [(562,154,3),(565,147,3),(567,142,3),(571,137,3),(575,133,3),(579,128,3),(582,123,3),(518,119,3)] whiteC
    ++addColour [(570,148,3),(575,143,3),(579,138,3),(584,135,3),(589,131,3),(595,129,3),(602,127,3),(609,125,3),(618,124,3)] whiteC
--part d
listPartd1 = addColour [(618,320,3),(626,326,3.5),(634,332,5),(649,338,7.4),(621,344,3),(625,350,3),(631,354,3.3),(638,359,3.6),(614,368,3),(609,392,6),(620,396,4),(627,402,3.2),(634,406,3)] brownC
 ++addColour[(664,339,4),(674,339,3),(671,346,3),(682,342,3.4),(678,350,3.4),(691,337,4),(690,350,4.8)]yellowTC
 ++move (addColour[(664,339,4),(674,339,3),(671,346,3),(682,342,3.4),(678,350,3.4),(691,337,4),(690,350,4.8)]yellowTC) (-16) 24
 ++addColour [(620,373,3),(627,377,3),(641,380,3),(634,382,3.4),(640,390,3.8),(641,389,3.89),(648,386,3.5),(647,395,4.3),(665,393,3),(657,404,5),(665,394,3),(668,402,3.7),(673,396,3),(677,402,3),(685,401,3),(623,414,3),(632,420,3.4),(640,425,4),(656,391,4)]yellowTC
--part c
listPartc = addColour [(708, 373, 3), (712, 367, 3.5), (715, 360, 3.5), (721, 353, 3.8), (731, 351, 3.8), (741, 355, 4), (751, 359, 4), (762, 364, 5.6), (773, 370, 4.5), (780, 376, 4.2), (781, 381, 3)] yellowTC `addR` 0.3
 ++addColour [(719,367,3),(726,361,3.5),(734,361,4),(743,365,4),(751,370,4),(759,375,3.8),(767,378,3.5),(774,381,3.2),(782,384,3)]whiteC

--part j
listPartj = addColour 
 [(659,466,3),(665,463,3),(671,459,3),(677,456,3),(682,454,3),(695,448,3),(709,445,3),(718,444,3)] whiteC
listPartj2 = addColour [(674,465,3),(680,463,3),(686,461,3),(693,460,3),(699,459,3),(705,457,3),(712,455,3),(718,455,3),(725,453,3),(731,452,3),(738,451,3),(744,451,3),(752,449,3),(758,448,3),(764,447,3),(771,446,3),(777,445,3),(785,444,3),(792,444,3),(798,444,3),(804,444,3),(812,444,3),(818,444.5,3),(826,444.5,3),(833,445,3),(841,446,3),(850,448.5,3),(859,452,3)]white
listPartj3 = addColour [(687,472,3),(694,471,3),(701,470,3),(708,470,3),(715,468,3),(762,467,3)]whiteC
listPartj4 = addColour [(680,485,3),(686,464,3),(694,482,3),(699,481,3),(706,479,3),(718,478,3),(725,475,3),(731,473,3),(738,472,3),(744,471,3),(751,469,3),(763,467,3),(468,466,3),(776,466,3),(782,464,3),(788,464,3),(797,445,3),(801,465,3),(806,464,3),(812,464,3),(820,464,3)] whiteC 
listPartj5 = extendLine2 (647, 502, whiteC, 3) 8 (-1) 9
 ++addColour[(747,486,3),(753,485,3),(759,485,3),(772,482,3),(778,481,3),(791,479,3),(796,478,3),(803,477,3),(816,476,3),(828,474,3),(834,474,3),(848,471,3),(855,468,3),(861,467,3),(867,466,3),(873,465,3),(881,465,3),(888,466,3),(896,466,3),(902,468,3)]whiteC
 ++ addColour [(698,486,3),(704,487,3),(712,487,3),(723,487,3),(730,487,3),(736,489,3),(742,490,3),(748,492,3),(754,595,3),(761,497,3),(768,498,3),(774,500,3),(780,502,3),(787,502,3),(793,502,3),(800,512,3),(807,515,3),(832,527,3),(839,530,3)]whiteC
 ++ addColour[(653,517,3),(661,516,3),(667,516,3),(673,515,3),(679,516,3),(685,517,3),(691,516,3),(697,517,3),(704,517,3),(710,515,3),(716,515,3),(723,515,3),(736,515,3),(742,515,3),(756,517,3),(748,516,3),(768,518,3),(775,519,3),(780,519,3),(786,520,3),(793,521,3),(800,521,3),(805,522,3),(811,521,3),(818,521,3),(825,521,3),(838,520,3),(831,520,3),(845,519,3),(852,518,3),(860,517,3),(867,516,3),(877,516,3),(886,513,3)]whiteC
 ++ addColour [(689,451,3),(703,447,3),(687,484,3),(713,478,3),(718,486,3),(455,494,3),(729,515,3),(766,484,3),(785,480,3),(810,476,3),(822,475,3),(841,472,3),(755,495,3),(763,468,3),(654,531,3),(513,534,3),(757,468,3),(762,517,3)] whiteC
 ++ addColour[(470,470,12),(514,535,8),(753,594,10)]black
--helper functions

extendLine2 :: (Float, Float, Color, Float) -> Float -> Float  -> Int -> [(Float, Float, Color, Float)]
extendLine2 _ _ _ 0 = []
extendLine2 (a, b, c, r) x y times = [(a, b, c, r)] ++ extendLine2 (a + x, b + y, c, r) x y (times -1)


changeCoor = [(x-500,500-y,c,d) | (x,y,c,d) <- list]
    
addR :: [(Float, Float, Color, Float)]->Float->[(Float, Float, Color, Float)]
addR xs  y = [(a,b,c,d+y)|(a,b,c,d)<-xs]

move :: [(Float, Float, Color, Float)] -> Float->Float -> [(Float, Float, Color, Float)]
move xs x y = [(a+x, b+y, c, d ) | (a, b, c, d) <- xs]

addColour :: [(Float, Float, Float)] ->Color-> [(Float, Float, Color , Float)]
addColour lst color = [(x, y, color,r) | (x, y, r) <- lst]

extendLine :: (Float, Float, Float) -> Float -> Float -> Float -> Int -> [(Float, Float, Float)]
extendLine _ _ _ _ 0 = []
extendLine (a, b, c) x y r times = [(a, b, c)] ++ extendLine (a + x+r*6, b + y + r*2.5, c + r) x y r (times -1)

--main
pic = pictures [Translate x y (Color c $ circleSolid d) | (x,y,c,d) <- changeCoor]

main = display (InWindow "By Henry Zhang and Cong Xiong" (1000,1000) (1000,0)) black pic